# 交互式菜单使用指南 / Interactive Menu Guide

## 🎯 为什么使用交互式菜单？

**问题：** 命令行参数太多，难以记住
- ❌ 需要记住 `--modes`, `--runs`, `--p-loss` 等参数
- ❌ 需要用英文输入
- ❌ 容易输错参数
- ❌ 不友好的用户体验

**解决：** 交互式菜单系统
- ✅ 只需输入数字选择
- ✅ 支持中文、日文、英文提示
- ✅ 逐步引导，不会出错
- ✅ 适合演示和日常使用

---

## 🚀 快速开始

### 方法 1：一键启动（推荐）

```bash
./run.sh
```

### 方法 2：手动启动

```bash
python interactive.py
```

### 方法 3：带虚拟环境

```bash
source .venv/bin/activate
python interactive.py
```

---

## 📋 主菜单说明

启动后你会看到：

```
================================================================================
║                 Replay Attack Simulation - Interactive Menu                  ║
║                           リプレイ攻撃シミュレーション - 対話型メニュー                           ║
║                                重放攻击仿真 - 交互式菜单                                ║
================================================================================

主菜单 Main Menu
================================================================================

  1. 🎯 快速演示 Quick Demo Scenarios
  2. 🔧 自定义实验 Custom Experiment
  3. 📊 批量实验 Batch Experiments
  4. 📈 数据可视化 Visualization
  5. 📚 查看帮助 View Help
  6. 🚪 退出程序 Exit

请选择 (1-6):
```

---

## 1️⃣ 快速演示 Quick Demo

**用途：** 答辩演示、快速展示效果

**包含场景：**

```
1. 基线对比 Baseline
   - 所有4种防御机制对比（理想网络）
   - 耗时：约 1-2 分钟
   
2. 丢包测试 Packet Loss
   - 10%丢包率下的防御效果
   - 耗时：约 1-2 分钟
   
3. 乱序测试 Reordering
   - 30%乱序率下的防御效果
   - 耗时：约 1-2 分钟
   
4. 恶劣网络 Harsh Network
   - 丢包+乱序的极端条件
   - 耗时：约 1-2 分钟
   
5. 选择性攻击 Selective
   - 针对UNLOCK命令的攻击
   - 耗时：约 1-2 分钟
   
6. 快速测试 Quick Test
   - 30次快速运行（约30秒）
   - 适合答辩现场演示
```

**操作步骤：**
1. 在主菜单输入 `1`
2. 选择场景（1-6）
3. 自动运行，显示实时进度
4. 查看结果

---

## 2️⃣ 自定义实验 Custom Experiment

**用途：** 完全控制实验参数

**7步配置流程：**

### 步骤 1：选择防御机制

```
【步骤 1/7】选择防御机制 Defense Mechanisms
--------------------------------------------------------------------------------
  1. 无防御 No Defense (基线)
  2. 滚动计数器 Rolling Counter + MAC
  3. 滑动窗口 Sliding Window
  4. 挑战响应 Challenge-Response
  5. 全部对比 All mechanisms (推荐)

请选择 (输入数字 1-5):
```

### 步骤 2：运行次数

```
【步骤 2/7】Monte Carlo 运行次数
--------------------------------------------------------------------------------
  1. 20次 - 快速测试 (约10-20秒)
  2. 50次 - 标准测试 (约30-60秒) [推荐答辩]
  3. 100次 - 详细测试 (约1-2分钟)
  4. 200次 - 严格测试 (约2-4分钟)
  5. 自定义 Custom
```

### 步骤 3-7：其他参数

- **步骤 3:** 正规传输次数（推荐：20）
- **步骤 4:** 重放攻击次数（推荐：100）
- **步骤 5:** 丢包率（0.0 = 无丢包，0.1 = 10%）
- **步骤 6:** 乱序率（0.0 = 无乱序，0.3 = 30%）
- **步骤 7:** 高级选项（窗口大小、目标命令）

### 最后确认

```
================================================================================
📋 实验配置总结 Experiment Summary
================================================================================
  防御机制: window
  运行次数: 50
  正规传输: 20 per run
  重放攻击: 100 per run
  丢包率: 5.00%
  乱序率: 0.00%
  窗口大小: 5
================================================================================

确认运行? (y/n):
```

---

## 3️⃣ 批量实验 Batch Experiments

**用途：** 自动运行多个实验，收集完整数据

**可用批量任务：**

```
1. 丢包率扫描 P-Loss Sweep
   - 测试不同丢包率 (0%, 5%, 10%, 15%, 20%)
   - 耗时：5-10 分钟
   
2. 乱序率扫描 P-Reorder Sweep
   - 测试不同乱序率 (0%, 10%, 20%, 30%)
   - 耗时：4-8 分钟
   
3. 窗口大小扫描 Window Sweep
   - 测试不同窗口大小 (1, 3, 5, 7, 9)
   - 耗时：5-10 分钟
   
4. 运行次数扫描 Runs Sweep
   - 测试不同运行次数的收敛性
   - 耗时：2-5 分钟
```

---

## 4️⃣ 数据可视化 Visualization

**用途：** 生成论文用的图表

**可用选项：**

```
1. 生成所有图表 Generate All Plots
   - 生成5张PNG图表
   - 保存到 figures/ 目录
   
2. 只生成丢包图 P-Loss Plots
   - p_loss_legit.png
   - p_loss_attack.png
   
3. 只生成乱序图 P-Reorder Plots
   - p_reorder_legit.png
   
4. 只生成窗口对比图 Window Tradeoff Plot
   - window_tradeoff.png
   
5. 导出表格数据 Export Tables
   - 生成 docs/metrics_tables.md
```

---

## 💡 使用技巧

### 答辩演示推荐流程

1. **开场**（2分钟）
   - 启动：`./run.sh`
   - 选择：`1` (快速演示)
   - 选择：`6` (快速测试 30秒)

2. **深入讲解**（5分钟）
   - 选择：`1` (快速演示)
   - 选择：`1` (基线对比)
   - 边运行边讲解

3. **回答问题**（3分钟）
   - 如果需要特定场景
   - 选择：`2` (自定义实验)
   - 按提示调整参数

### 日常使用建议

**快速测试：**
```
启动 → 1 → 6  (快速测试场景)
```

**完整对比：**
```
启动 → 1 → 1  (基线对比)
```

**自定义实验：**
```
启动 → 2 → 按提示配置
```

**批量数据收集：**
```
启动 → 3 → 选择扫描类型
```

---

## 🎯 常见场景快捷键

| 场景 | 快捷操作 | 耗时 |
|------|---------|------|
| 答辩快速演示 | `1` → `6` | 30秒 |
| 完整对比 | `1` → `1` | 2分钟 |
| 丢包测试 | `1` → `2` | 2分钟 |
| 乱序测试 | `1` → `3` | 2分钟 |
| 自定义实验 | `2` → 按提示 | 可变 |
| 批量实验 | `3` → 选择类型 | 5-10分钟 |
| 生成图表 | `4` → `1` | 10秒 |

---

## 🔄 对比：命令行 vs 交互式

### 命令行方式（旧）

```bash
# 需要记住并输入完整参数
python main.py \
    --modes no_def rolling window challenge \
    --runs 100 \
    --num-legit 20 \
    --num-replay 100 \
    --p-loss 0.1 \
    --p-reorder 0.3 \
    --window-size 5

# 优点：脚本化
# 缺点：难记、易错、不直观
```

### 交互式方式（新）

```bash
# 启动交互式菜单
./run.sh

# 然后按提示操作：
# 1. 选择 "2" (自定义实验)
# 2. 选择 "5" (全部对比)
# 3. 选择 "3" (100次运行)
# 4. 输入 "20" (正规传输)
# 5. 输入 "100" (重放攻击)
# 6. 输入 "0.1" (丢包率)
# 7. 输入 "0.3" (乱序率)
# 8. 选择 "1" (默认高级选项)
# 9. 输入 "y" (确认)

# 优点：直观、易用、不会出错
# 缺点：交互式（不适合脚本）
```

---

## ❓ 常见问题

### Q1: 如何快速退出？
A: 按 `Ctrl+C` 或在主菜单选择 `6`

### Q2: 可以在运行中途退出吗？
A: 可以，按 `Ctrl+C` 安全退出

### Q3: 交互式菜单支持批处理吗？
A: 不支持。批处理请使用命令行模式：
   ```bash
   python main.py --modes window --runs 50
   ```

### Q4: 如何保存实验结果？
A: 在自定义实验的高级选项中可以指定输出文件

### Q5: 忘记参数含义怎么办？
A: 在主菜单选择 `5` (查看帮助)

### Q6: 可以同时运行多个实验吗？
A: 不建议。一次运行一个实验，避免资源冲突

---

## 🎓 答辩使用建议

### 推荐流程

**时间紧张（< 5分钟）：**
```
1. 启动交互式菜单
2. 选择 "快速测试" (30秒)
3. 边运行边讲解
4. 展示结果表格
```

**时间充裕（10-15分钟）：**
```
1. 启动交互式菜单
2. 选择 "基线对比" (2分钟)
3. 选择 "丢包测试" (2分钟)
4. 选择 "乱序测试" (2分钟)
5. 讲解每个结果
```

### 讲解要点

**启动时：**
- "我开发了一个交互式菜单系统，使用简单"
- "只需输入数字选择，无需记住参数"

**运行时：**
- "可以看到实时的进度条和统计数据"
- "这是Monte Carlo仿真，每次运行都有随机性"

**结果展示：**
- "最终结果清晰展示了各种防御机制的效果"
- "标准差显示了统计的可靠性"

---

## 🚀 高级用法

### 组合使用

**方案1: 交互式演示 + 命令行批处理**
```bash
# 答辩时用交互式
./run.sh

# 收集数据用命令行
python main.py --quiet --modes window --runs 200 --output-json results/data.json
```

**方案2: 快速实验 + 详细分析**
```bash
# 快速测试参数
./run.sh → 1 → 6

# 确认后详细运行
./run.sh → 2 → 配置详细参数
```

---

## 📝 总结

| 特性 | 命令行模式 | 交互式模式 |
|-----|----------|-----------|
| **易用性** | ⭐⭐ | ⭐⭐⭐⭐⭐ |
| **学习曲线** | 陡峭 | 平缓 |
| **脚本化** | ✅ | ❌ |
| **答辩演示** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |
| **批处理** | ✅ | ⭐⭐⭐ |
| **出错率** | 高 | 低 |

**推荐：**
- 答辩演示 → 交互式
- 日常开发 → 交互式
- 批量实验 → 命令行
- 自动化脚本 → 命令行

---

🎉 享受更简单的实验体验！

